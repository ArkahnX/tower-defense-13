/*! @source http://purl.eligrey.com/github/classList.js/blob/master/classList.js*/

(function(t,n){function st(e,t){var n;if(Array.isArray(e))for(n=0;n<e.length;n++)t.call(e[n],n);else for(n in e)t.call(e[n],n)}function ot(e,t,n,r){return"rgba("+e+","+t+","+n+","+(r||1)+")"}function ut(e,t){s[_]=e,s[D]=t,o.clearRect(0,0,e,t)}function at(e,t,n,r){var i,s=Object.create(null);for(var o in e)t&&n?(i=t.indexOf(o),i>-1?s[o]=n[i](e,o,r):s[o]=e[o]):s[o]=e[o];return s}function ft(e){return e-50<0?0:e-50}function lt(e){return e[v.x][v.y]}function ct(e,t){e.health-=t}function ht(e){return rt[W].round(e)}function pt(e){return rt[W][z](e)}function dt(e,t){return ht(e*h+it-t)}function vt(e,t){return ht(e*h+it-t/2)}function mt(e,t){return pt(rt[W].random()*(t-e+1))+e}function gt(){var e=0;for(var t=0;t<C[U];t++)e+=C[t].priority;var n=mt(0,e-1);for(var t=0;t<C[U];t++){if(n<C[t].priority)return t;n-=C[t].priority}return!1}function yt(e,t,n){var r=[];for(var i in e)e[i][t]===n&&r[X](e[i]);return r.length?r:!1}function bt(e,t){var n=e%t;return(e-n)/t}function wt(e,t){return Math.random()*(t-e)+e}function Et(e,t,n){return{"red":e,"green":t,"blue":n}}function St(e,t,n){return n?2*e*t+2*t*n+2*e*n:e*t}function xt(){s=r[I]("canvas"),s[_]=l*h,s[D]=c*h,o=s.getContext("2d"),b.push(function(e,t){o.drawImage(e.image,vt(e.x,h),vt(e.y,h))}),w.push(function(e,t){t!==0&&(o.drawImage(t.image,vt(t.x,t.width),dt(t.y,t.height)),jn(t))}),E.push(function(){Mn(),wn(),xn(),Ut(),Bn(),zt(),Dn(),f++,y--,N[0].length&&f===120?(f=0,Bt()):f===600&&(m++,N.splice(0,1),g=N[0].length,y=g*120+600,f=0)}),T[X]($t("Base","none","special",0,1e4,1e3,0,0,[[10,15],[20,30],[10,15]],[Et(225,0,0),Et(ft(225),0,0)])),T[X]($t("Cannon","cannon","basic",7,50,10,10,20,[[10,15],[10,15],[5,10]],[Et(200,0,0),Et(ft(200),0,0)])),T[X]($t("Shotgun","spread","basic",5,50,10,50,20,[[15,20],[15,20],[10,15]],[Et(125,0,0),Et(ft(125),ft(125),0)])),T[X]($t("Gatling","beam","basic",5,50,10,0,20,[[20,25],[20,25],[15,20]],[Et(125,0,0),Et(0,0,125)])),T[X]($t("Explode","explode","basic",5,50,10,50,20,[[25,30],[25,30],[20,25]],[Et(125,0,0),Et(0,ft(125),ft(125))])),C.push(Tt("grass",G,7,1,Ct([[1024,175,230,1.3,1,2],[50,200,245,1,1.3,1.5],[100,125,175,2,1,2]]))),C.push(Tt("darkGrass",G,7,1,Ct([[1024,150,205,1.3,1,2],[50,175,220,1,1.3,1.5],[100,100,150,2,1,2]]))),C.push(Tt("road","fast",4,.5,Ct([[1024,0,0,1,1,1],[600,0,50,1,1,1]]))),C.push(Tt("water","slow",3,1.5,Ct([[1024,100,200,1.5,1.5,1],[600,100,200,1.5,1.5,1]]))),Pt(10),jt(13),g=N[0].length,y=g*120+600}function Tt(e,t,n,r,i){var u=[];ut(32,32);var a=3;for(var f=0;f<a;f++){var d=mt(i[0].fromColor,i[0].toColor);o.fillStyle=ot(ht(d/i[0].redFactor),ht(d/i[0].greenFactor),ht(d/i[0].blueFactor)),o.fillRect(0,0,h,h);for(var v=0;v<i[U];v++)Nt(i[v]);var m=new Image;m[Y]=s[J](),u[X](m),ut(l*h,c*h)}var g=p;return p++,s[_]=l*h,s[D]=c*h,{"name":e,"is":"terrain","type":t,"x":0,"y":0,"image":u,"images":u[U],"priority":n,"id":g,"speed":r}}function Nt(e){var t,n,r=0,i=0;for(t=0;t<e.pixels;t++)r=mt(0,h-1),i=mt(0,h-1),n=mt(e.fromColor,e.toColor),o.fillStyle=ot(ht(n/e.redFactor),ht(n/e.greenFactor),ht(n/e.blueFactor)),o.fillRect(r,i,1,1)}function Ct(e){var t=[];for(var n=0;n<e.length;n++)t.push({"pixels":e[n][0],"fromColor":e[n][1],"toColor":e[n][2],"redFactor":e[n][3],"greenFactor":e[n][4],"blueFactor":e[n][5]});return t}function kt(e,t,n){return e[t][mt(0,e.images-1)]}function Lt(e,t,n){return n[0]}function At(e,t,n){return n[1]}function Ot(e,t){for(var n=0;n<e;n++){S[n]=S[n]||[],x[n]=x[n]||[];for(var r=0;r<t;r++){var i=gt(),s=at(C[i],["image","x","y"],[kt,Lt,At],[n,r]);S[n][r]=s,x[n][r]=0}}a=at(T[0]),a.x=mt(e/2-1,t/2+1),a.y=mt(e/2-1,t/2+1),x[a.x][a.y]=a}function Mt(){var e,t,n,r;for(e=0;e<S[U];e++)for(t=0;t<S[e][U];t++)for(n=0;n<b[U];n++)b[n](S[e][t],x[e][t]);for(e=0;e<S[U];e++)for(t=0;t<S[e][U];t++)for(n=0;n<w[U];n++)w[n](S[e][t],x[e][t]);for(r=0;r<E[U];r++)E[r]()}function _t(e,t){var r=[];for(var i=0;i<S.length;i++){r[i]=r[i]||[];for(var s=0;s<S[i].length;s++){var o=at(C[S[i][s].id],["image","x","y"],[kt,Lt,At],[i,s]);x[i][s]&&x[i][s][M].toLowerCase()!=="base"&&(o.speed=0),r[i][s]=o}}return e!==n&&t!==n&&(r[e][t]=at(C[r[e][t].id],["image","x","y"],[kt,Lt,At],[e,t]),r[e][t].speed=0),r}function Dt(e){var t=[];for(var n=0;n<e.length;n++)for(var r=0;r<e[n].length;r++)if(n===0||n===e.length-1||r===0||r===e[n].length-1)if(e[n][r].speed!==0){var i=ln.search(e,e[n][r],e[a.x][a.y]);i.length&&t.push(!0)}else t.push(!1);return t}function Pt(e){for(var t=1;t<e+1;t++){var n=t/2,r=7;n*2>r&&(r=n*2),k.push({"level":t,"size":r,"speed":n*.5,"health":t*10,"fullHealth":n*10,"targetX":null,"targetY":null,"path":null,"x":null,"y":null,"pixelX":null,"pixelY":null,"pathIndex":0,"color":"rgb(0,0,0)","red":0,"green":0,"blue":0})}}function Ht(e){var t,n=0;do{do{var r=0,i=0;if(side===0||side===2)r=mt(0,l-1),side===2&&(i=l-1);else if(side===1||side===3)i=mt(0,c-1),side===1&&(r=c-1);n++;var s=_t()}while(s[r][i].speed===0);data.x=r,data.y=i,data.pixelX=vt(r,data.size),data.pixelY=vt(i,data.size),t=Xt([data],s)}while(!t.length);return data.path=t,data.targetX=t[0].x,data.targetY=t[0].y,data.pathIndex=0,e}function Bt(){if(N[0]){var e=N[0].splice(0,1)[0],t,n=0;do{do{var r=mt(0,3),i=0,s=0;if(r===0||r===2)i=mt(0,l-1),r===2&&(s=l-1);else if(r===1||r===3)s=mt(0,c-1),r===1&&(i=c-1);n++;var o=_t()}while(o[i][s].speed===0);e.x=i,e.y=s,e.pixelX=vt(i,e.size),e.pixelY=vt(s,e.size),t=Xt([e],o)}while(!t.length);e.path=t,e.targetX=t[0].x,e.targetY=t[0].y,e.pathIndex=0,L.push(e)}}function jt(e){for(var t=1;t<e+1;t++){var n=[],r=0;for(var i=t;i>0;i--){for(var s=0;s<i*2;s++){var o=at(k[r]);n.push(o)}r=ht(t/e*(k.length-1))}N.push(n)}}function Ft(e,t,n){return n[0]}function It(e,t,n){return n[1]}function qt(e,t,n){return vt(n[0],e.size)}function Rt(e,t,n){return vt(n[1],e.size)}function Ut(){st(L,function(e){var t=this;t.health<1?Wt(t,e):(o.beginPath(),o.strokeStyle="white",o.lineWidth=2,o.strokeRect(t.pixelX,t.pixelY,t.size,t.size),o.fillStyle=t.color,o.fillRect(t.pixelX,t.pixelY,t.size,t.size),o.fill(),o.closePath())})}function zt(){st(L,function(e){var t=this;if(t.pathIndex<t[G][U]){var n=t[G][t.pathIndex];t.x=bt(t.pixelX+t.size/2,h),t.y=bt(t.pixelY+t.size/2,h),t.targetX=n.x,t.targetY=n.y;var r=S[t.x][t.y],i=t[nt]/r[nt],s=vt(t.targetX,t.size),o=vt(t.targetY,t.size);ht(t.pixelX)<s?t.pixelX+i>s?t.pixelX=s:t.pixelX+=i:ht(t.pixelY)<o?t.pixelY+i>o?t.pixelY=o:t.pixelY+=i:ht(t.pixelX)>s?t.pixelX-i<s?t.pixelX=s:t.pixelX-=i:ht(t.pixelY)>o&&(t.pixelY-i<o?t.pixelY=o:t.pixelY-=i),ht(t.pixelX)===vt(t.targetX,t.size)&&ht(t.pixelY)===vt(t.targetY,t.size)&&t.pathIndex++}t.x===a.x&&t.y===a.y&&(tn(t),Wt(t,e))})}function Wt(e,t){var n=e.pixelX,r=e.pixelY,i=e.size/2;Pn(pt(e.health/e.fullHealth*e.size)+1,60,[2,7],[-2,2,-2,2],[n,r-i,n+i,r+i],[ot(e.red,e.green,e.blue),ot(ft(e.red),ft(e.green),ft(e.blue))]),Ln(e.fullHealth*10),L.splice(t,1)}function Xt(e,t){var n=[],r,i,s;return st(e,function(e){i=this,s=t||_t(),r=ln.search(s,s[i.x][i.y],s[a.x][a.y]),n[X](!!r.length)}),n.indexOf(!1)>-1?!1:r}function Vt(e){st(e,function(e){var t=this,n=Xt([t]);t.path=n,t.pathIndex=0,t.targetX=n[0].x,t.targetY=n[0].y})}function $t(e,t,n,r,i,s,o,u,a,f){var l=Jt(t,a,f);return{"is":"tower","name":e,"weapon":t,"width":l.width,"height":l.height,"depth":l.depth,"path":l.path,"colors":l.colors,"image":Kt(l),"x":l.x,"y":l.y,"type":n,"range":r,"delay":o,"speed":u,"timer":0,"cost":i,"health":s,"fullHealth":s}}function Jt(e,t,n){var r=mt(t[0][0],t[0][1]),i=mt(t[1][0],t[1][1]),s=mt(t[2][0],t[2][1]),o="rectangle";return e!=="none"&&(o="triangle"),{"x":0,"y":0,"width":r,"height":i,"depth":s,"colors":n,"path":o}}function Kt(e){var t=s[_],n=s[D];ut(e.width,e.height+e.depth),Yt[e.path](e);var r=new Image;return r[Y]=s[J](),ut(t,n),r}function Qt(e,t,n,r,i,s){o.beginPath(),o.rect(e,t,n,r),o.fillStyle=i,o.fill(),o.closePath()}function Gt(e,t,n,r,i,s,u){o.beginPath(),o.moveTo(e,t),o.lineTo(i,s),o.lineTo(n,r),o.closePath(),o.fillStyle=u,o.fill(),o.closePath()}function Zt(){if(a!==null)return a;if(a===null){var e=en();if(e)return a=x[e.x][e.y],a}return!1}function en(){for(var e=0;e<x[U];e++)for(var t=0;t<x[e][U];t++)if(x[e][t][M]==="base")return{"x":e,"y":t};return!1}function tn(e){An(e.health),ct(a,e.health);if(a.health<1){nn(a.x,a.y),a=null;var t=Zt();t||gameOver()}}function nn(e,t){var n=x[e][t],r=vt(t,h),i=r-n.height/2,s=r+n.height,o=vt(e,h),u=o+it-n.width/2,a=o+n.width,f=[];for(var l=0;l<n.colors.length;l++){var c=n.colors[l];f.push(ot(c.red,c.green,c.blue))}Pn(20,50,[2,7],[-2,2,-2,2],[u,i,a,s],f,!0),x[e][t]=0}function rn(e,t){var n=x[e][t];Ln(n.cost*(n.health/n.fullHealth)/2),nn(e,t)}function sn(){var e=un().cost;d=null,Ln(e)}function on(){return un()?!0:!1}function un(){return d===K?!1:yt(T,M,d)[0]}function an(){if(lt(x)!==0)return K;if(!on())return!0;var e=_t(v.x,v.y);if(Dt(e).indexOf(!0)===-1)return!1;if(L[U]){var t=yt(L,"x",v.x);if(yt(t,"y",v.y)[U])return!1;var t=yt(L,"targetX",v.x);if(yt(t,"targetY",v.y)[U])return!1;var e=_t(v.x,v.y);if(!Xt(L,e))return!1}return un().is==="terrain"?!0:lt(S).type===G?!0:un().is==="trap"&&lt(S).type==="fast"?!0:!1}function fn(){r[I](Q).children[U]>0&&(r[I](Q)[F]="");var e=[];for(var t=0;t<T[U];t++){var n=T[t],i=P+">"+n[M]+j,s=P+" class='cost'>$"+n.cost+j,o="<img src='"+n.image.src+"'>",u=H+" class='container' title='"+n.is+": "+n[M]+" ($"+n.cost+")"+"'>"+o+i+s+B;e.push(""+u+"")}r[I](Q)[F]=e.join(""),vn()}function cn(e){this.content=[],this.scoreFunction=e}function hn(){pn(),u=requestAnimationFrame(hn)}function pn(){ut(l*h,c*h),Mt()}function dn(){r[I]("loading")[$].add("hidden")}function vn(){var e=r[R](".container");for(var t=0;t<e[U];t++)En(e[t],"click",gn)}function mn(e){e.preventDefault()}function gn(e){mn(e);var t=this;!t[$].contains("expensive")&&!on()&&(d=t[q]("span").innerText,An(yt(T,M,d)[0].cost))}function yn(e){mn(e);if(on()&&an())if(e.which===2)sn();else{var t=at(un(),["x","y"],[Lt,At],[v.x,v.y]);x[v.x][v.y]=t,d=null,On(),L.length&&Vt(L)}an()===null&&e.which===2&&(a.x!==v.x||a.y!==v.y)&&rn(v.x,v.y)}function bn(e){v.x=e.pageX-s.offsetLeft,v.y=e.pageY-s.offsetTop,v.x=bt(v.x,h),v.y=bt(v.y,h)}function wn(){strokeColor="black",an()&&on()?strokeColor="green":an()===K?strokeColor="blue":an()||(strokeColor="red")}function En(e,t,n){Sn(e,t,n),e.addEventListener(t,n,!0)}function Sn(e,t,n){e.removeEventListener(t,n)}function xn(){var e=v.x*32,t=v.y*32;o.strokeStyle=strokeColor,o.lineWidth=2,o.strokeRect(e,t,32,32),o.strokeStyle="#FFF",o.strokeRect(e-2,t-2,36,36)}function Tn(){for(i=0;i<k[U];i++){var t=k[i];for(e=0;e<t.path.length;e++){var n=t.path[e];o.beginPath(),o.fillStyle="rgba(100,100,100,0.5)",o.fillRect(n.x*h,n.y*h,h,h),o.fill(),o.closePath()}}}function Nn(){for(i=0;i<k[U];i++){var t=k[i],n=_t(v.x,v.y),r=getBaseCoords(),s=ln.search(n,n[t.x][t.y],n[r.x][r.y]);for(e=0;e<s.length;e++){var u=s[e];o.beginPath(),o.fillStyle="rgba(0,255,0,0.5)",o.fillRect(u.x*h,u.y*h,h,h),o.fill(),o.closePath()}}}function Cn(){cancelAnimationFrame(u)}function Ln(e){kn+=e,On()}function An(e){kn-=e,On()}function On(){var e=r[R](".container");for(var t=0;t<e[U];t++){e[t][$].remove("expensive"),e[t][$].remove("building");var n=e[t][q](".cost").innerText.substring(1);parseInt(n,10)>kn&&e[t][$].add("expensive"),un()&&e[t][$].add("building")}}function Mn(){var e=Zt().health,t="<li>",n="</li>",i="<code>",s="</code>",o=[];o[X]("Base Health: "+i+e+s),o[X]("Wave: "+i+m+s),o[X]("Enemies: "+i+g+s),o[X]("Enemies Remaining: "+i+(N[0].length+L.length)+s),o[X]("Time until Next Wave: "+i+y+s),o[X]("money: "+i+kn+s),r[I]("data")[F]="<ul>"+t+o.join(n+t)+n+"</ul>"}function _n(e,t,n,r,i,s,o,u,a,f,l,c){var p=i/3,d=h/60*mt(i+p,i-p),v=mt(0,c.length);return{"x":mt(e,n),"y":mt(t,r),"w":mt(s,o),"h":mt(s,o),"dx":wt(u,a),"dy":wt(f,l),"life":d,"lifespan":d,"color":c[v]}}function Dn(){for(var e=0;e<A.length;e++){var t=A[e];o.beginPath(),o.fillStyle=t.color,o.fillRect(t.x,t.y,t.w,t.h),o.fill(),o.closePath(),t.life=t.life-1,t.life>0?(t.x=t.x+t.dx,t.y=t.y+t.dy):A.splice(e,1)}}function Pn(e,t,n,r,i,s){for(var o=0;o<e;o++)A.push(_n(i[0],i[1],i[2],i[3],t,n[0],n[1],r[0],r[1],r[2],r[3],s))}function Hn(e){var t=0,n=e.length;waitForParticles}function Bn(){for(var e=0;e<O.length;e++){var t=O[e];if(t.x+t.radius>s.width||t.y+t.radius>s.height||t.x<0||t.y<0)O.splice(e,1);else{var n=qn(t);if(n){O.splice(e,1),ct(n,t.damage);var r=n.pixelX,i=n.pixelY,u=n.size/2;Pn(pt(t.damage/n.fullHealth*n.size)+1,60,[2,7],[-2,2,-2,2],[r,i-u,r+u,i+u],[ot(n.red,n.green,n.blue),ot(ft(n.red),ft(n.green),ft(n.blue))])}else{o.beginPath(),o.fillStyle="rgba("+t.red+","+t.green+","+t.blue+","+t.life/t.maxLife+")",o.arc(t.x,t.y,t.radius,0,2*Math.PI,!1),o.fill(),o.closePath();if(t.life>0||t.life<0)t.targetX>0&&t.targetY>0?(t.x-=t.speed*t.dx,t.y-=t.speed*t.dy):t.targetX<0&&t.targetY>0?(t.x-=t.speed*t.dx,t.y-=t.speed*t.dy):(t.x+=t.speed*t.dx,t.y+=t.speed*t.dy),t.life--;t.life===0&&O.splice(e,1)}}}}function jn(e){e.timer>=e.delay&&st(L,function(t){var n=this,r=vt(e.x,1),i=vt(e.y,1,e.size)-e.height,s=e.range*h;if(Fn(r,i,s,n.pixelX,n.pixelY,n.size/2)&&e.timer>=e.delay){var o=r-n.pixelX,u=i-n.pixelY,a=Math.atan(o/u),f=e.speed/60*Math.sin(a),l=e.speed/60*Math.cos(a),c=mt(200,255),p=mt(0,100),d=mt(0,100);In(e.weapon,o,u,50,3,e.speed,r,i,f,l,c,d,p,1,1),e.timer=0}}),e.timer++}function Fn(e,t,n,r,i,s){var o=e-r,u=t-i,a=n+s;return o*o+u*u<=a*a}function In(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){if(e==="cannon")O.push({"radius":i,"x":o,"y":u,"dx":a,"dy":f,"red":l,"green":c,"blue":h,"alpha":p,"life":r,"maxLife":r,"speed":s,"targetX":t,"targetY":n,"damage":d||1});else if(e==="spread")for(var v=0;v<5;v++){var l=mt(0,100),c=mt(0,100),h=mt(100,255);In("cannon",t,n,25,3,s,o,u,wt(a-a/2,a+a/2),wt(f-f/2,f+f/2),l,c,h,p,2)}else if(e==="beam")O.push({"radius":i,"x":o,"y":u,"dx":wt(a-a/2,a+a/2),"dy":wt(f-f/2,f+f/2),"red":l,"green":c,"blue":h,"alpha":p,"life":1e3,"maxLife":100,"speed":20,"targetX":t,"targetY":n,"damage":1});else if(e==="explode")for(var v=0;v<25;v++)O.push({"radius":i,"x":o,"y":u,"dx":wt(-2,2)/60,"dy":wt(-2,2)/60,"red":l,"green":c,"blue":h,"alpha":p,"life":25,"maxLife":25,"speed":120,"targetX":t,"targetY":n,"damage":5})}function qn(e){for(var t=0;t<L.length;t++){var n=L[t];if(Fn(n.pixelX,n.pixelY,n.size/2,e.x,e.y,e.radius))return n}return!1}var r=t.document,s,o,u=null,a=null,f=0,l=20,c=20,h=32,p=0,d=null,v={"x":0,"y":0},m=1,g=0,y=0,b=[],w=[],E=[],S=[],x=[],T=[],N=[],C=[],T=[],k=[],L=[],A=[],O=[],M="name",_="width",D="height",P="<span",H="<div",B="</div>",j="</span>",F="innerHTML",I="getElementById",q="querySelector",R=q+"All",U="length",z="floor",W="Math",X="push",V="rgb(",$="classList",J="toDataURL",K=null,Q="towers",G="path",Y="src",Z="cost",et="next",tt="color",nt="speed",rt=t,it=h/2;rt.addEventListener("DOMContentLoaded",function(){xt(),fn(),Ot(l,c),Ln(500),En(s,"mousemove",bn),En(s,"mousedown",yn),En(s,"contextmenu",mn),hn(),dn()});var Yt={"triangle":function(e){var t=e.x,n=e.y,r=e.depth,i=e.width,s=e.height,o=i/2,u=e.colors;Gt(o+t,n,t,n+s,t+o,n+s+r,ot(u[0].red,u[0].green,u[0].blue)),Gt(o+t-1,n,o+t-1,n+s+r,t+i,n+s,ot(u[1].red,u[1].green,u[1].blue))},"rectangle":function(e){var t=e.colors;Qt(e.x,e.y+e.depth/2,e.width,e.height,ot(t[0].red,t[0].green,t[0].blue)),Qt(e.x,e.y,e.width,e.depth,ot(t[1].red,t[1].green,t[1].blue))}},ln={"init":function(e){for(var t=0,n=e[U];t<n;t++)for(var r=0,i=e[t][U];r<i;r++){var s=e[t][r];s.f=0,s.g=0,s.h=0,s[Z]=s[nt],s.visited=!1,s.closed=!1,s.parent=K}},"heap":function(){return new cn(function(e){return e.f})},"search":function(e,t,n){ln.init(e),heuristic=ln.manhattan;var r=ln.heap();r[X](t);while(r.size()>0){var i=r.pop();if(i===n){var s=i,o=[];while(s.parent)o[X](s),s=s.parent;return o.reverse()}i.closed=!0;var u=ln.neighbors(e,i);for(var a=0,f=u[U];a<f;a++){var l=u[a];if(l.closed||l[nt]===0)continue;var c=i.g+l[Z],h=l.visited;if(!h||c<l.g)l.visited=!0,l.parent=i,l.h=l.h||heuristic(l.x,l.y,n.x,n.y),l.g=c,l.f=l.g+l.h,h?r.rescoreElement(l):r[X](l)}}return[]},"manhattan":function(e,t,n,r){var i=rt[W].abs(n-e),s=rt[W].abs(r-t);return i+s},"neighbors":function(e,t){var n=[],r=t.x,i=t.y;return e[r-1]&&e[r-1][i]&&n[X](e[r-1][i]),e[r+1]&&e[r+1][i]&&n[X](e[r+1][i]),e[r]&&e[r][i-1]&&n[X](e[r][i-1]),e[r]&&e[r][i+1]&&n[X](e[r][i+1]),n}};cn.prototype={"push":function(e){this.content[X](e),this.sinkDown(this.content[U]-1)},"pop":function(){var e=this.content[0],t=this.content.pop();return this.content[U]>0&&(this.content[0]=t,this.bubbleUp(0)),e},"size":function(){return this.content[U]},"rescoreElement":function(e){this.sinkDown(this.content.indexOf(e))},"sinkDown":function(e){var t=this.content[e];while(e>0){var n=(e+1>>1)-1,r=this.content[n];if(!(this.scoreFunction(t)<this.scoreFunction(r)))break;this.content[n]=t,this.content[e]=r,e=n}},"bubbleUp":function(e){var t=this.content[U],n=this.content[e],r=this.scoreFunction(n);for(;;){var i=e+1<<1,s=i-1,o=K;if(s<t){var u=this.content[s],a=this.scoreFunction(u);a<r&&(o=s)}if(i<t){var f=this.content[i],l=this.scoreFunction(f);l<(o===K?r:a)&&(o=i)}if(o===K)break;this.content[e]=this.content[o],this.content[o]=n,e=o}}};var kn=0;(function(){var e=0,t=["ms","moz","webkit","o"];for(var n=0;n<t[U]&&!rt.requestAnimationFrame;++n)rt.requestAnimationFrame=rt[t[n]+"RequestAnimationFrame"],rt.cancelAnimationFrame=rt[t[n]+"CancelAnimationFrame"]||rt[t[n]+"CancelRequestAnimationFrame"];rt.requestAnimationFrame||(rt.requestAnimationFrame=function(t,n){var r=(new Date).getTime(),i=rt[W].max(0,16-(r-e)),s=rt.setTimeout(function(){t(r+i)},i);return e=r+i,s}),rt.cancelAnimationFrame||(rt.cancelAnimationFrame=function(e){clearTimeout(e)})})(),typeof r!="undefined"&&!("classList"in r.createElement("a"))&&function(e){"use strict";var t="classList",n="prototype",r=(e.HTMLElement||e.Element)[n],i=Object,s=String[n].trim||function(){return this.replace(/^\s+|\s+$/g,"")},o=Array[n].indexOf||function(e){var t=0,n=this.length;for(;t<n;t++)if(t in this&&this[t]===e)return t;return-1},u=function(e,t){this.name=e,this.code=DOMException[e],this.message=t},a=function(e,t){if(t==="")throw new u("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(t))throw new u("INVALID_CHARACTER_ERR","String contains an invalid character");return o.call(e,t)},f=function(e){var t=s.call(e.className),n=t?t.split(/\s+/):[],r=0,i=n.length;for(;r<i;r++)this.push(n[r]);this._updateClassName=function(){e.className=this.toString()}},l=f[n]=[],c=function(){return new f(this)};u[n]=Error[n],l.item=function(e){return this[e]||null},l.contains=function(e){return e+="",a(this,e)!==-1},l.add=function(e){e+="",a(this,e)===-1&&(this.push(e),this._updateClassName())},l.remove=function(e){e+="";var t=a(this,e);t!==-1&&(this.splice(t,1),this._updateClassName())},l.toggle=function(e){e+="",a(this,e)===-1?this.add(e):this.remove(e)},l.toString=function(){return this.join(" ")};if(i.defineProperty){var h={"get":c,"enumerable":!0,"configurable":!0};try{i.defineProperty(r,t,h)}catch(p){p.number===-2146823252&&(h.enumerable=!1,i.defineProperty(r,t,h))}}else i[n].__defineGetter__&&r.__defineGetter__(t,c)}(self)})(window)